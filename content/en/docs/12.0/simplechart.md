---
title: "12.3 Create a Chart"
weight: 123
sectionnumber: 12.3
---

In this lab we're going to create our very first Helm chart and deploy it.


## Task {{< param sectionnumber >}}.1: Create Chart

First let's create our chart:

```bash
helm create mychart
```

You'll now find a `mychart` directory with the newly created chart. It already is a valid and fully functional chart which deploys nginx. Have a look at the generated files and their content. For an explanation of the files, visit the [Helm Developer Documentation](https://docs.helm.sh/developing_charts/#the-chart-file-structure). In a later section you'll find all the information about Helm templates.


## Task {{< param sectionnumber >}}.2: Install Release

Before actually deploying our generated chart, we can check the (to be) generated Kubernetes resources with the following command:


```bash
helm install --dry-run --debug --namespace <NAMESPACE> myfirstrelease ./mychart
```

Finally, the following command creates a new release and deploys the application:

```bash
helm install --namespace <NAMESPACE> myfirstrelease ./mychart
```

The `--name` parameter allows you to give your release a name, it is not mandatory though, the name will be autogenerated if no explicit name is provided.

With `kubectl get pods --namespace <NAMESPACE>` you should see a new pod. You can list the newly created Helm release with the following command:

```bash
helm ls --namespace <NAMESPACE>
```


## Task {{< param sectionnumber >}}.3: Expose Application

Our freshly deployed nginx is not yet accessible from outside of the Kubernetes cluster. To expose it, we have to change the service type to `NodePort`.
Search now for the Service type definition in your chart and make the change.


### Solution
A look into the file `templates/service.yaml` reveals that the service type is set by value:
```yaml
[...]
spec:
  type: {{ .Values.service.type }}
[...]
```

Thus we need to change this value inside our `values.yaml` file:
```yaml
[...]
service:
  type: NodePort
  port: 80
[...]
```

Apply the change by upgrading our release:


```bash
helm upgrade --namespace <NAMESPACE> myfirstrelease ./mychart 
```

You will see in the following command's output when the service gets a `NodePort` (as we use `--watch` you have to terminate the command with CTRL-C):

```bash
kubectl get svc --namespace <NAMESPACE> --watch
```

nginx is now available at the given port number indicated by the `NodePort` and should display a welcome page when accessing it with `curl` or your browser of choice.


{{% alert title="Tip" color="warning" %}}
Use `kubectl get node -o wide` to get a node ip address. Remember, [NodePort's](https://kubernetes.io/docs/concepts/services-networking/service/#nodeport) are open on any kubernetes node
{{% /alert %}}


## Task {{< param sectionnumber >}}.4: Overwrite value using commandline param

An alternative way to set or overwrite values for charts we want to deploy is the `--set name=value` parameter. `--set name=value` can be used when installing a chart as well as upgrading.

Update the replica count of your nginx Deployment to 2 using `--set name=value`


### Solution

```bash
helm upgrade --namespace <NAMESPACE> --set replicaCount=2 myfirstrelease ./mychart 
```

Values that have been set using `--set` can be reset by helm upgrade with `--reset-values`.


## Task {{< param sectionnumber >}}.5: Remove release

To remove an application, simply remove the Helm release with the following command:

```bash
helm delete myfirstrelease
```

Do this with our deployed release. With `kubectl get pods --namespace <NAMESPACE>` you should no longer see your application pod.
